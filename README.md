# DESCRIPTION:

This project provides a look into New York City's parking violations, highlighting their frequency, key determinants, and time-series forecasts. We take a precinct-based approach to investigate parking violations, and present our findings in an interactive visualization hosted at https://nyc-traffic.github.io/.

This package guides the user through downloading and cleaning the data, analysis, and then setting up the interactive UI. We use Python 3.7 for data cleaning and precinct-wise trend and time series analysis. The UI is built using D3.js, and we have included the d3 scripts required. We have provided a directory structure at the end of this README for your reference.

You can also check out our project poster (team019poster.pdf) and project report (team019report.pdf).


# INSTALLATION: 

Our findings can be found at https://nyc-traffic.github.io/. To run the application locally:

* Clone the git repository.
* Use Python version 3.7 or higher.
* Download the required data from https://data.cityofnewyork.us/browse?Data-Collection_Data-Collection=DOF+Parking+Violations+Issued&q=&sortBy=alpha&utf8=%E2%9C%93 and place into ./data/main_data/raw.
* Additionally, download collisions data from https://www.nyc.gov/site/nypd/stats/traffic-data/traffic-data-archive.page and place into ./data/collisions_data. 
* Generate the cleaned data files using ./code/data_cleaning/clean_data.ipynb. Then run ./code/data_cleaning/separate_data.ipynb to separate data for further cleaning.
* Generate the correlation analysis data by running all the files provided within ./code/correlation_analysis/ sequentially.
* Generate clean data for time series analysis ./code/time_series/Time Series Cleaning Code.ipynb and generate forecasts using Prediction Values ipynb notebooks sequentially (Part 2, 3, 4). You can also access our analysis using Time Series Prediction Trial.ipynb.
	Note that Notebooks Prediction Values 2, 3 and 4 take a long time to run, since each model is hyperparameterized for each precinct.
* Generate concatenated data set for choropleth exploratory analysis using ./code/Combiner.ipynb.
* Generate concatenated data set for line graph using ./code/Time Series Combiner.ipynb.
After this, you can carry out the steps in Execution.


# EXECUTION 

To set up the Python server:
* Open command prompt and type "python -m http.server 8000" (this starts a server on localhost:8000).
* When the server is running, navigate to http://localhost:8000/.../visualization/index.html (This path will depend on your local directory)

You can now observe our application. There are two main functions to our app:

* Unveiling Correlations: Analyzing Parking Violations in NYC Through Precincts. 
This section displays choropleths of NYC. Use the dropdown to navigate between different choropleths (Month End Increase in Tickets, Most Common Type of Violation, Number of Collisions, Ticketing Frequency by Plate Type, Ticketing Frequency by Time of Day, Ticketing Frequency by Vehicle Color, and Ticketing Frequency by Vehicle Type). The two sliders can be used to change the Year and Month under observation. If data is unavailable, the user will be prompted to view a different time period. Each of the choropleths has a short description of their function at the top right, and a legend explaining the colors.

* Predicting The Future: Analyzing Parking Violations in NYC Through Precincts.
This section displays the time series forecasts for different precincts. A dropdown allows users to choose precincts. Forecasts generated by ARIMA and Prophet are displayed in the line graph.


# Directory Structure:

Here is a look into our directory structure:
```
root
|-- code: Contains all the code you need to run to recreate our project.
|  |-- Combiner.ipynb
|  |-- Time Series Combiner.ipynb
|  |-- correlation_analysis: This code generates all files within ./data/final_data_to_join.
|  |  |-- Clean_Data(Time_of_Day).ipynb
|  |  |-- Parking Fines to CSV.ipynb
|  |  |-- Parking Max Code to CSV.ipynb
|  |  |-- car_types.ipynb
|  |  |-- clean_and_extract_color.ipynb
|  |  |-- clean_and_extract_platetype.ipynb
|  |  |-- collisions.ipynb
|  |  |-- cop_quota.ipynb
|  |-- data_cleaning: This code generates clean data from our raw sample.
|  |  |-- clean_data.ipynb
|  |  |-- separate_data.ipynb
|  |-- data_combiner.ipynb
|  |-- time_series : This code generates both clean data and analysis for time series forecasting.
|  |  |-- Prediction Values Part 2.ipynb
|  |  |-- Prediction Values Part 3.ipynb
|  |  |-- Prediction Values Part 4 - no2015andcovid.ipynb
|  |  |-- Time Series Cleaning Code.ipynb
|  |  |-- Time Series Prediction Trial.ipynb
|-- data : This folder contains all intermediate and final data.
|  |-- Parking Violation Code.csv 
|  |-- collisions_data
|  |-- final_data_to_join : This contains all the files generated by the code in ./code/correlation_analysis.
|  |  |-- car_types_max_percentage_names.csv
|  |  |-- collisions.csv
|  |  |-- collisions_temp
|  |  |-- color_data.csv
|  |  |-- ema_violation_counts.csv
|  |  |-- fines_data.csv
|  |  |-- max_violation_data.csv
|  |  |-- plate_type_data.csv
|  |  |-- potential_quotas.csv
|  |  |-- time_of_day_summary.csv
|  |-- main_data : This folder contains our raw sample and our intermediate outputs as generated by the code in ./code/clean_data.
|  |  |-- cleaned
|  |  |-- color_and_plate_type
|  |  |-- raw
|  |  |-- raw.zip
|  |  |-- time_of_day
|  |-- time_series : This contains the intermediate cleaned data and forecasts as generated by the code in ./code/time_series.
|  |  |-- cleaned
|  |  |-- line_graph_monthly_data.csv
|  |  |-- precinct_line_graphs
|  |  |-- precinct_line_graphs_nocovid
|-- visualization : This folder contains all the D3.js source files required for our visualization.
|  |-- .git
|  |  |-- COMMIT_EDITMSG
|  |  |-- FETCH_HEAD
|  |  |-- HEAD
|  |  |-- config
|  |  |-- description
|  |  |-- hooks
|  |  |-- index
|  |  |-- info
|  |  |-- logs
|  |  |-- objects
|  |  |-- packed-refs
|  |  |-- refs
|  |-- NYC_Police_Precincts.geojson
|  |-- choropleth_data.csv
|  |-- choropleth_map.js
|  |-- index.html
|  |-- lib  
|  |  |-- d3-dsv.min.js
|  |  |-- d3-geo-projection.v2.min.js
|  |  |-- d3-legend.min.js 
|  |  |-- d3-tip.min.js
|  |  |-- d3.v5.min.js
|  |  |-- topojson.v2.min.js
|  |-- line_graph.js
|  |-- line_graph_output_data.csv
|  |-- range_updater.js 
```